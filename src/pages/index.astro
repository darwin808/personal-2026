---
import BaseLayout from '@layouts/BaseLayout.astro';
import About from '@components/sections/About.astro';
import Experience from '@components/sections/Experience.astro';
import Projects from '@components/sections/Projects.astro';
import ThemeToggle from '@components/ui/ThemeToggle.astro';
import { SOCIAL_LINKS } from '@utils/constants';

const pageTitle = 'Darwin Apolinario - Full-Stack Software Engineer, AI Developer & Tech Expert';
const pageDescription =
  'Darwin Apolinario: Expert Full-Stack Software Engineer specializing in AI/ML, LLM integration (GPT-4, Claude), React, TypeScript, Node.js, Rust. Building intelligent applications with modern tech stack: AWS, Docker, Kubernetes. Proven experience at Metrobank, Zesty.io. Active open-source contributor on GitHub.';
---

<BaseLayout title={pageTitle} description={pageDescription}>
  <ThemeToggle />
  <div class="mouse-glow"></div>

  <div class="mx-auto max-w-screen-xl lg:flex lg:justify-between lg:gap-4">
    <!-- Left Sidebar - Sticky -->
    <header
      class="px-6 py-12 lg:sticky lg:top-0 lg:flex lg:max-h-screen lg:w-1/2 lg:flex-col lg:justify-between lg:px-12 lg:pt-34 lg:pb-24"
    >
      <div>
        <h1 class="text-gruvbox-fg0 text-4xl font-bold tracking-tight sm:text-5xl">
          Darwin Apolinario
        </h1>
        <h2 class="text-gruvbox-fg mt-3 text-lg font-medium tracking-tight sm:text-xl">
          Full-Stack Software Engineer & AI Developer
        </h2>
        <p class="text-gruvbox-fg3 mt-4 max-w-xs leading-normal">
          I architect scalable, AI-powered applications and cloud-native solutions that drive
          business impact.
        </p>

        <!-- Navigation -->
        <nav class="nav mt-16 hidden lg:block" aria-label="In-page jump links">
          <ul class="w-max">
            <li>
              <a
                class="group flex items-center py-3 transition-transform hover:translate-x-1"
                href="#about"
              >
                <span
                  class="nav-indicator bg-gruvbox-gray group-hover:bg-gruvbox-yellow mr-4 h-px w-8 transition-all duration-300 group-hover:w-16"
                ></span>
                <span
                  class="nav-text text-gruvbox-gray group-hover:text-gruvbox-yellow text-xs font-bold tracking-widest uppercase transition-colors duration-300"
                  >About</span
                >
              </a>
            </li>
            <li>
              <a
                class="group flex items-center py-3 transition-transform hover:translate-x-1"
                href="#experience"
              >
                <span
                  class="nav-indicator bg-gruvbox-gray group-hover:bg-gruvbox-yellow mr-4 h-px w-8 transition-all duration-300 group-hover:w-16"
                ></span>
                <span
                  class="nav-text text-gruvbox-gray group-hover:text-gruvbox-yellow text-xs font-bold tracking-widest uppercase transition-colors duration-300"
                  >Experience</span
                >
              </a>
            </li>
            <li>
              <a
                class="group flex items-center py-3 transition-transform hover:translate-x-1"
                href="#projects"
              >
                <span
                  class="nav-indicator bg-gruvbox-gray group-hover:bg-gruvbox-yellow mr-4 h-px w-8 transition-all duration-300 group-hover:w-16"
                ></span>
                <span
                  class="nav-text text-gruvbox-gray group-hover:text-gruvbox-yellow text-xs font-bold tracking-widest uppercase transition-colors duration-300"
                  >Projects</span
                >
              </a>
            </li>
          </ul>
        </nav>
      </div>

      <!-- Social Links -->
      <ul class="mt-8 flex items-center gap-5" aria-label="Social media">
        {
          SOCIAL_LINKS.map((social) => (
            <li class="text-xs">
              <a
                href={social.url}
                target="_blank"
                rel="noopener noreferrer"
                class="text-gruvbox-fg3 hover:text-gruvbox-yellow block transition-all duration-200 hover:-translate-y-1 hover:scale-110"
                aria-label={social.platform}
              >
                <svg
                  class="h-6 w-6"
                  fill="none"
                  stroke="currentColor"
                  stroke-width="2"
                  stroke-linecap="round"
                  stroke-linejoin="round"
                >
                  {social.platform === 'GitHub' && (
                    <path d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37 0 0 0-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44 0 0 0 20 4.77 5.07 5.07 0 0 0 19.91 1S18.73.65 16 2.48a13.38 13.38 0 0 0-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07 0 0 0 5 4.77a5.44 5.44 0 0 0-1.5 3.78c0 5.42 3.3 6.61 6.44 7A3.37 3.37 0 0 0 9 18.13V22" />
                  )}
                  {social.platform === 'LinkedIn' && (
                    <>
                      <path d="M16 8a6 6 0 0 1 6 6v7h-4v-7a2 2 0 0 0-2-2 2 2 0 0 0-2 2v7h-4v-7a6 6 0 0 1 6-6z" />
                      <rect x="2" y="9" width="4" height="12" />
                      <circle cx="4" cy="4" r="2" />
                    </>
                  )}
                  {social.platform === 'CodePen' && (
                    <>
                      <polygon points="12 2 22 8.5 22 15.5 12 22 2 15.5 2 8.5 12 2" />
                      <line x1="12" y1="22" x2="12" y2="15.5" />
                      <polyline points="22 8.5 12 15.5 2 8.5" />
                      <polyline points="2 15.5 12 8.5 22 15.5" />
                      <line x1="12" y1="2" x2="12" y2="8.5" />
                    </>
                  )}
                  {social.platform === 'Email' && (
                    <>
                      <path d="M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z" />
                      <polyline points="22,6 12,13 2,6" />
                    </>
                  )}
                </svg>
              </a>
            </li>
          ))
        }
      </ul>
    </header>

    <!-- Right Content - Scrollable -->
    <main id="content" class="px-6 lg:w-1/2 lg:px-12 lg:py-8">
      <About />
      <Experience />
      <Projects />

      <footer class="mt-24 pb-16">
        <p class="text-gruvbox-fg3 text-sm">
          &copy; {new Date().getFullYear() - 2} Darwin Apolinario. All rights reserved.
        </p>
      </footer>
    </main>
  </div>
</BaseLayout>

<style>
  .mouse-glow {
    pointer-events: none;
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    z-index: 30;
    transition: opacity 0.3s;
    mix-blend-mode: screen;
  }

  html[data-theme='light'] .mouse-glow {
    mix-blend-mode: multiply;
    opacity: 1;
  }

  .nav-indicator {
    transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  }

  .nav-text {
    transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  }

  a.active .nav-indicator {
    width: 4rem;
    background-color: #fabd2f;
  }

  a.active .nav-text {
    color: #fabd2f;
  }
</style>

<script>
  // Mouse glow effect
  const mouseGlow = document.querySelector('.mouse-glow') as HTMLElement;
  const html = document.documentElement;

  const updateMouseGlow = (x: number, y: number) => {
    if (!mouseGlow) return;

    const isLightMode = html.getAttribute('data-theme') === 'light';

    if (isLightMode) {
      // More visible in light mode with darker yellow/orange
      mouseGlow.style.background = `radial-gradient(600px circle at ${x}px ${y}px, rgba(215, 153, 33, 0.25), rgba(215, 153, 33, 0.12) 40%, transparent 70%)`;
    } else {
      // Original dark mode glow
      mouseGlow.style.background = `radial-gradient(800px circle at ${x}px ${y}px, rgba(250, 189, 47, 0.15), rgba(250, 189, 47, 0.05) 40%, transparent 80%)`;
    }
  };

  document.addEventListener('mousemove', (e) => {
    updateMouseGlow(e.clientX, e.clientY);
  });

  // Active nav on scroll
  const sections = document.querySelectorAll('section[id]');
  const navLinks = document.querySelectorAll('.nav a');

  const updateActiveNav = () => {
    let current = '';

    sections.forEach((section) => {
      const sectionTop = section.offsetTop;
      const sectionHeight = section.clientHeight;
      if (window.scrollY >= sectionTop - 200) {
        current = section.getAttribute('id') || '';
      }
    });

    // If no section is active (at top of page), default to first section
    if (!current && sections.length > 0) {
      current = sections[0].getAttribute('id') || '';
    }

    navLinks.forEach((link) => {
      link.classList.remove('active');
      if (link.getAttribute('href') === `#${current}`) {
        link.classList.add('active');
      }
    });
  };

  // Update on scroll
  window.addEventListener('scroll', updateActiveNav);

  // Update on initial load
  updateActiveNav();
</script>
